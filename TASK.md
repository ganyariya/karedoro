# karedoro 開発タスク一覧

**最終更新日**: 2025-01-16  
**ステータス**: イテレーション1-3完了、基本機能実装済み

## 完了済み: イテレーション1: プロジェクト基盤とドメイン層 ✅

### 1.1 プロジェクトセットアップ ✅
- [x] go.mod ファイルの作成
- [x] 必要な依存関係の追加
  - [x] github.com/hajimehoshi/ebiten/v2 v2.8.8
  - [x] github.com/ebitengine/oto/v3 v3.3.3
  - [x] github.com/gen2brain/beeep v0.11.1
- [x] プロジェクト構造の作成（DDD アーキテクチャ）
  - [x] domain/ ディレクトリ
  - [x] application/ ディレクトリ
  - [x] presentation/ ディレクトリ
  - [x] assets/ ディレクトリ（音声ファイル用）

### 1.2 定数とタイプ定義 ✅
- [x] セッション時間の定数定義
  - [x] WORK_SESSION_DURATION (25分)
  - [x] BREAK_SESSION_DURATION (5分)
  - [x] WARNING_INTERVAL (5分)
- [x] セッション状態の型定義
  - [x] SessionState enum (WorkSession, BreakSession, Idle)
  - [x] SessionType enum (Work, Break)
- [x] その他の定数定義
  - [x] UI関連の定数（色、サイズなど）

### 1.3 ドメイン層の実装 ✅
- [x] セッション管理のドメインロジック
  - [x] Session struct の定義
  - [x] Timer struct の実装
  - [x] 状態遷移ロジックの実装
- [x] セッション状態マネージャーの実装
  - [x] 状態変更の処理
  - [x] タイマーの開始・停止・一時停止
  - [x] 警告システムのロジック

## 完了済み: イテレーション2: アプリケーション層とコア機能 ✅

### 2.1 アプリケーション層の実装 ✅
- [x] セッションサービスの実装
  - [x] セッション開始・終了の処理
  - [x] 状態変更の通知機能
  - [x] バックグラウンド処理の管理
- [x] 設定管理サービスの実装
  - [x] 設定ファイルの読み書き
  - [x] デフォルト設定の適用

### 2.2 音声システムの実装 ✅
- [x] 音声ファイルの準備（プログラム生成音声）
  - [x] セッション開始音
  - [x] セッション終了音
  - [x] 警告音
- [x] 音声再生システムの実装
  - [x] ebitengine/oto v3 を使った音声再生
  - [x] プログラム生成による効果音
  - [x] 音量制御機能

### 2.3 通知システムの実装 ✅
- [x] システム通知の実装
  - [x] beeep を使った通知機能
  - [x] クロスプラットフォーム対応
  - [x] 通知メッセージの定数化（英語対応）

## 完了済み: イテレーション3: UI層とユーザーインタラクション ✅

### 3.1 基本UI の実装 ✅
- [x] ebitengine ベースのゲームループ
- [x] 基本的なウィンドウ設定
- [x] フォント表示（英語対応）
- [x] 基本的なレイアウトシステム

### 3.2 セッション画面の実装 ✅
- [x] 作業セッション画面
  - [x] カウントダウンタイマーの表示
  - [x] スペースキーによる一時停止・再開
  - [x] 進捗表示
- [x] 休憩セッション画面
  - [x] カウントダウンタイマーの表示
  - [x] スペースキーによる一時停止・再開
  - [x] 進捗表示

### 3.3 全画面オーバーレイの実装 ✅
- [x] セッション終了時の全画面表示
- [x] ボタンの配置とスタイリング
  - [x] "Start Break Session" ボタン
  - [x] "Skip Break -> Work" ボタン
  - [x] "Start Work Session" ボタン
- [x] メッセージの表示
- [x] キーボード・マウス入力の処理

## 完了済み: イテレーション4: 高度な機能と制約 ✅

### 4.1 ウィンドウ制御の実装 ✅
- [x] 全画面モードの制御
  - [x] ebiten.SetFullscreen() の実装
- [x] ウィンドウクローズイベントの処理
  - [x] ebiten.SetWindowClosingHandled() の実装
  - [x] バックグラウンド動作の継続

### 4.2 警告システムの実装 ✅
- [x] 待機状態での定期警告
- [x] 警告タイマーの管理
- [x] 音声付き通知の実装

### 4.3 一時停止機能の実装 ✅
- [x] セッション中の一時停止
- [x] 一時停止状態のUI表示
- [x] 再開機能の実装

## 完了済み: イテレーション5: テストと品質保証 ✅

### 5.1 単体テストの実装 ✅
- [x] ドメイン層のテスト
  - [x] セッション管理ロジックのテスト (18テスト)
  - [x] 状態遷移のテスト
  - [x] タイマー機能のテスト（一時停止・再開修正含む）
- [x] アプリケーション層のテスト
  - [x] セッションサービスのテスト (9テスト)
  - [x] 設定管理のテスト

### 5.2 統合テストの実装 🚧
- [x] 音声システムの動作確認
- [x] 通知システムの動作確認
- [ ] UI インタラクションのテスト（手動確認済み）

### 5.3 品質保証 ✅
- [x] タイマー機能のバグ修正
- [x] フォント表示問題の修正
- [x] .gitignore整備

## イテレーション6: パッケージングと配布

### 6.1 ビルドシステムの構築
- [ ] クロスプラットフォームビルドの設定
- [ ] アセットの埋め込み
- [ ] 実行ファイルの最適化

### 6.2 配布準備
- [ ] インストーラーの作成（必要に応じて）
- [ ] ドキュメントの整備
- [ ] リリースノートの作成

## 開発ガイドライン

### 各イテレーション後に実行すること
1. `go build` でビルドエラーがないことを確認
2. `go test ./...` でテストが通ることを確認
3. 動作確認（手動テスト）
4. コードリファクタリング
5. 必要に応じてコミット

### 品質チェックリスト
- [ ] マジックナンバーを使用していない
- [ ] 適切な型定義を使用している
- [ ] エラーハンドリングが適切に実装されている
- [ ] コードが読みやすく整理されている
- [ ] テストが意味のある範囲をカバーしている

## 優先度
- **高**: イテレーション1-3（基本機能の実装）
- **中**: イテレーション4-5（高度な機能とテスト）
- **低**: イテレーション6（パッケージングと配布）

## 🎉 実装完了済み機能

### 現在の実装状況
- **完了率**: 90%（イテレーション1-5完了）
- **動作状況**: 完全に動作する状態
- **テストカバレッジ**: 27テストケース（Domain: 18, Application: 9）

### 主要な修正・改善履歴
- **タイマーバグ修正**: 一時停止・再開時の時間計算問題を解決
- **フォント表示修正**: 日本語から英語に変更してフォント互換性を確保
- **音声システム**: oto v3対応、プログラム生成による効果音実装
- **.gitignore整備**: ビルド成果物の適切な除外設定

### 次のステップ（優先度低）
- クロスプラットフォームビルドの自動化
- リリースパッケージの作成
- 詳細なユーザードキュメント作成

## 備考
- 各イテレーションは独立して動作する機能を含むように設計
- 早期に動作するプロトタイプを作成し、段階的に機能を追加
- テストファーストではなく、機能実装後にテストを追加する方針
- **実行方法**: `go run .` または `go build && ./karedoro`